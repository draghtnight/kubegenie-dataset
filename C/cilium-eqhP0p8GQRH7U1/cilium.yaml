apiVersion: v1
kind: ServiceAccount
metadata:
  name: cilium
  namespace: eqhP0p8GQRH7U1
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: cilium-operator
  namespace: eqhP0p8GQRH7U1
---
apiVersion: v1
kind: Secret
metadata:
  name: hubble-ca-secret
  namespace: eqhP0p8GQRH7U1
data:
  ca.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURLRENDQWhDZ0F3SUJBZ0lSQUp1SHg3M1BjVWpyTEY5RE5NZndKUWt3RFFZSktvWklodmNOQVFFTEJRQXcKSGpFY01Cb0dBMVVFQXhNVGFIVmlZbXhsTFdOaExtTnBiR2wxYlM1cGJ6QWVGdzB5TWpBMk1USXdPVEl6TkRkYQpGdzB5TlRBMk1URXdPVEl6TkRkYU1CNHhIREFhQmdOVkJBTVRFMmgxWW1Kc1pTMWpZUzVqYVd4cGRXMHVhVzh3CmdnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUJEd0F3Z2dFS0FvSUJBUURrUURrVEhPVVRJNzNFZEJpQ2hncTIKcFBWTkZ4WmlHWVNlalpsdUNqU3J1M2o2a21zT0paclNjcy9kcVc2R09DaGdHTGZUZGQzTktzdSs4Um5lZ2M2cgpldzR0dk9Pa1AwM1U2bG5FZ3dTREcyQWJsbkE0ZjBveTRiby9MUjc3NWU5M1dZOUZDQ2FxTElOTC9pU3hQbEhhCklIMUJERWNwNmhsSHUrSHBuL1YrOVdySC8wMzZOK3orcEFOTm5UTDloNWlJK1NqeFE3UE95QUJpTlZSRVJKb00KV3l6VTRra2FtUlByOUN2SHNyeWhVMDcycXRZWXFnWkxLblUwQlVtUno5TnYwM1RSeUliRHVGL1pEc0c2UFY1ZQoycGJUNjhnZGN2bmVWcVlyNUNUVFB6WVlPR2NQS0wrNjd5R212RlBkQWxMd1hVTnd5ZUY0UWNRYzR1UEJkM3JYCkFnTUJBQUdqWVRCZk1BNEdBMVVkRHdFQi93UUVBd0lDcERBZEJnTlZIU1VFRmpBVUJnZ3JCZ0VGQlFjREFRWUkKS3dZQkJRVUhBd0l3RHdZRFZSMFRBUUgvQkFVd0F3RUIvekFkQmdOVkhRNEVGZ1FVMjlqQ2cydldvZEJPeVBvRApDNm5hdEVXLzdSa3dEUVlKS29aSWh2Y05BUUVMQlFBRGdnRUJBRS9RMXZUbk9aN0FaOTV2VXE5b2FqeXNpcFBoClpUak85MVNEaVo2cVNTU0NwU2ZwTS9XUUt0SUxOTmJacldBNXBWUFlHT1R0QnNSbTRjWkU0ZjJxS2JvdHUxeUIKdkhTYmlPdHFycklzQWRjbjgveXFhMGhjc2Q3dzNQUUYrUmplN2xVd2hiOVJHWDlCQ0lTZXNLTCtIYldpaitNbgpmclgrUWFVV0grYnVoSmRhcHRyL3JkUk1QNHM0WGlYejgwL0Fpa0ZqUjZPNUpQdDhKQ2RkQU8zbGxCN09oeUZ4CjVDQUQrelg5dXNlTTE2eUhUSWdqNEROWDZBOWVCMjM4bEJSbS81eFFsU2RldWU1WmRSWjFVc1lHUU5zN1d1VGIKdWtZQ09KU2tlRG9vdFY2YUJmVUtEbjU3NlVCVHpMMGl2cG9IY2dxL2Z5ZmdPSS9rWTV0ODlSY0owRzQ9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
  ca.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBNUVBNUV4emxFeU85eEhRWWdvWUt0cVQxVFJjV1lobUVubzJaYmdvMHE3dDQrcEpyCkRpV2EwbkxQM2FsdWhqZ29ZQmkzMDNYZHpTckx2dkVaM29IT3Ezc09MYnpqcEQ5TjFPcFp4SU1FZ3h0Z0c1WncKT0g5S011RzZQeTBlKytYdmQxbVBSUWdtcWl5RFMvNGtzVDVSMmlCOVFReEhLZW9aUjd2aDZaLzFmdlZxeC85TgoramZzL3FRRFRaMHkvWWVZaVBrbzhVT3p6c2dBWWpWVVJFU2FERnNzMU9KSkdwa1Q2L1FyeDdLOG9WTk85cXJXCkdLb0dTeXAxTkFWSmtjL1RiOU4wMGNpR3c3aGYyUTdCdWoxZVh0cVcwK3ZJSFhMNTNsYW1LK1FrMHo4MkdEaG4KRHlpL3V1OGhwcnhUM1FKUzhGMURjTW5oZUVIRUhPTGp3WGQ2MXdJREFRQUJBb0lCQUFyZmpGaCt2ZUxsaHZxKwoxUlFTc3B2MHk4SzZZTlNYaHB2Ty93b2c3bFZuL3VGZzdEeW1TZlBRaUZwMDRkRC9COTFjRUJYQXZhb3lhYlpVCjRmaVprbkRVMGQ0WDYzZzlrOFdhekYveUpkcmhDUGtIZDUwWll6MTlSMVFQSURTN3hXYVlHNTBjUUV0SEI1SXQKTHk1S1c3ZmFhRjBhNnFEeWgvWEUyNFEzbkloSnJaMzlxc1VtME1FTEZoNWVmRGd6eHhiSVlHSkV3NFVqQ2lUeQpRMG02d2dkQU1pbVIxTjJCUmFBamxHbDB5V05GZWpCRlhYWHRXaW4zd08zZnhoVThYVWNBekNzb0x6SXdNOE5PCllNUlNtVmFiL0ljcE5xY0p1WmUxaDVoNUdMVVRCeFZFN2M3RXhVc0FwWkJkUEpMaHpTSmZHVjNJK0JJMGRJZTUKc2Q0QSszRUNnWUVBOVdtV2kzN0hFNXJ3OXFJZVRkQ0dLcnoyZ3pUREsrSmNLR1cvSENBYkZPTjM1b1NrQlkvWAovb2tWZG82aXM3UGFvRWdGNmdyQXlOVlVTZnF4WmRBOWFIVXNrcEpSVFpVZjhDajAzQk1VWTdma21XS0xKUDJBCk1uOXhqYWZhLytLUlI2aWtJSnRTU1J6aHE2M2JIYnhjWHdKakxETWJQcWVSZk85akRWeGhEZjBDZ1lFQTdoa1kKMUo1b0FFUzNpOUFFZ1Q2M3NDdUFMSDFFMm13aEhxdVQ0alVNMXloZ25laEU4N3JMVXBzRnNiR3FuWUVwaEJCQwpZYkxUYThOcUJWNzlUWE9pOElaZkh1NUNEeXNKYnp4NHJuNE1lS3JKeUF5MFNvdXA2WWRQYkZGM3Z1dDBCd0xaCkVObWgrcWRueHVkdUxCMHNiZTMxTVQ1NWd6cytaMDV4eEdFKyttTUNnWUFQRmsrd0FicEJaVXdkRFhocGRrRloKVFVhbWFFNzdXcTRwdVorWEhnNHNLWlBNY3lrV1FuS1g3bHVJYjFwblM4NUwva0dHMHVScE5GdzdOQk5GM0JoNgpYSUhCL1FiTWl6ZHNiMGdtWTNIa2M0QzFRVTZtbG9NVUY2dW1kc1JLNk9YZmp1bVFLNXhTYkZrZlVjL2ZzeDNHCnBZSHRUTE1IRmd3bXJ4emF6R3dYRFFLQmdRQzVyVkN6M3FSME1TS0NJY0tobCt0ZnMwek5aUk5nMHBveGROUnEKdjd3M3ZnRTZvM3ZDSnBXUTRkdmE2eGFHcGNkZWVkK0ttUTVQSjZGeWR0VktwVGNZSTNIaWlTTnkrTGp1eWxYQwpuZ0hUeUR4N2lZeS81WktuenlHYzh4dFRCQU1EeExES2R5M2VidFo3UXRla0Iwd3luak5zSjdCVEtzeExlOTAwCnJER1V5UUtCZ0NBL3dSUTFyQTVkZElEVGxaZzlBaXVRcjgzVFh2M0FPZXpuRENzTGliOEh2VER4aHk0Y3BZOVMKRkVpR1dLZzlYeklaL2haTHMrcmc5OGFJVEhWTFZWb1FNN2ZMSEJsaWFlS01rTTZuNWxxOHBzbkZBU1g0STZiLwpjMTdLRHhrSEV4RitSNWQzK05DMkxXNldUYUxqVDRacjB0dmQ0bzRnaGVKb1BTa0E2cDNXCi0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==
---
apiVersion: v1
kind: Secret
metadata:
  name: hubble-server-certs
  namespace: eqhP0p8GQRH7U1
type: kubernetes.io/tls
data:
  ca.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURLRENDQWhDZ0F3SUJBZ0lSQUp1SHg3M1BjVWpyTEY5RE5NZndKUWt3RFFZSktvWklodmNOQVFFTEJRQXcKSGpFY01Cb0dBMVVFQXhNVGFIVmlZbXhsTFdOaExtTnBiR2wxYlM1cGJ6QWVGdzB5TWpBMk1USXdPVEl6TkRkYQpGdzB5TlRBMk1URXdPVEl6TkRkYU1CNHhIREFhQmdOVkJBTVRFMmgxWW1Kc1pTMWpZUzVqYVd4cGRXMHVhVzh3CmdnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUJEd0F3Z2dFS0FvSUJBUURrUURrVEhPVVRJNzNFZEJpQ2hncTIKcFBWTkZ4WmlHWVNlalpsdUNqU3J1M2o2a21zT0paclNjcy9kcVc2R09DaGdHTGZUZGQzTktzdSs4Um5lZ2M2cgpldzR0dk9Pa1AwM1U2bG5FZ3dTREcyQWJsbkE0ZjBveTRiby9MUjc3NWU5M1dZOUZDQ2FxTElOTC9pU3hQbEhhCklIMUJERWNwNmhsSHUrSHBuL1YrOVdySC8wMzZOK3orcEFOTm5UTDloNWlJK1NqeFE3UE95QUJpTlZSRVJKb00KV3l6VTRra2FtUlByOUN2SHNyeWhVMDcycXRZWXFnWkxLblUwQlVtUno5TnYwM1RSeUliRHVGL1pEc0c2UFY1ZQoycGJUNjhnZGN2bmVWcVlyNUNUVFB6WVlPR2NQS0wrNjd5R212RlBkQWxMd1hVTnd5ZUY0UWNRYzR1UEJkM3JYCkFnTUJBQUdqWVRCZk1BNEdBMVVkRHdFQi93UUVBd0lDcERBZEJnTlZIU1VFRmpBVUJnZ3JCZ0VGQlFjREFRWUkKS3dZQkJRVUhBd0l3RHdZRFZSMFRBUUgvQkFVd0F3RUIvekFkQmdOVkhRNEVGZ1FVMjlqQ2cydldvZEJPeVBvRApDNm5hdEVXLzdSa3dEUVlKS29aSWh2Y05BUUVMQlFBRGdnRUJBRS9RMXZUbk9aN0FaOTV2VXE5b2FqeXNpcFBoClpUak85MVNEaVo2cVNTU0NwU2ZwTS9XUUt0SUxOTmJacldBNXBWUFlHT1R0QnNSbTRjWkU0ZjJxS2JvdHUxeUIKdkhTYmlPdHFycklzQWRjbjgveXFhMGhjc2Q3dzNQUUYrUmplN2xVd2hiOVJHWDlCQ0lTZXNLTCtIYldpaitNbgpmclgrUWFVV0grYnVoSmRhcHRyL3JkUk1QNHM0WGlYejgwL0Fpa0ZqUjZPNUpQdDhKQ2RkQU8zbGxCN09oeUZ4CjVDQUQrelg5dXNlTTE2eUhUSWdqNEROWDZBOWVCMjM4bEJSbS81eFFsU2RldWU1WmRSWjFVc1lHUU5zN1d1VGIKdWtZQ09KU2tlRG9vdFY2YUJmVUtEbjU3NlVCVHpMMGl2cG9IY2dxL2Z5ZmdPSS9rWTV0ODlSY0owRzQ9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURZVENDQWttZ0F3SUJBZ0lSQUlwRFFia3JwemYxblpZbFJWUFhNRTh3RFFZSktvWklodmNOQVFFTEJRQXcKSGpFY01Cb0dBMVVFQXhNVGFIVmlZbXhsTFdOaExtTnBiR2wxYlM1cGJ6QWVGdzB5TWpBMk1USXdPVEl6TkRoYQpGdzB5TlRBMk1URXdPVEl6TkRoYU1Db3hLREFtQmdOVkJBTU1IeW91WkdWbVlYVnNkQzVvZFdKaWJHVXRaM0p3Cll5NWphV3hwZFcwdWFXOHdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCRHdBd2dnRUtBb0lCQVFDMDFVaHQKdVRVM2Y2cmUxM253UjVBRjU4T3ZJVVVHYUtzajN0Sml5T1QrMTJEbkRyNWhLOFBzOGU3elNiWXIrRzlFTERheApBUjlyVGxaR1d0MUh3THZCTVdqWGV3YWlOcjhuQ3Q3aHM5MUpTWncxZElVcFJYYi9vY2htTHI0Q0FnaFpjcnBBCnd2Z3ZQR252NWJTcHdZaGM5NFI5NEdSSnNIV1VJUGU5WnN2eGlHQ2d6QmIzTmxKZTFYL0djeWhTSVdyaytNQkgKNmY5TDNoVDRldHhuRVNFZHB2SWs5Sm9sM05BQkdseG03ZTJOb3cvdzFJb0pnWmkzZFNDb0kxVGg3bnRHSjh5TQpmWGNSUnRrYVpjajVuUE9WeitVejRFd0Q3Qk1PeHAyd3BwUE5SOXFyYk1BZnBNU1pRNG11Q1BKNUJnV28wWGYrCndHQW9ISUdPZmxpMjcwM2xBZ01CQUFHamdZMHdnWW93RGdZRFZSMFBBUUgvQkFRREFnV2dNQjBHQTFVZEpRUVcKTUJRR0NDc0dBUVVGQndNQkJnZ3JCZ0VGQlFjREFqQU1CZ05WSFJNQkFmOEVBakFBTUI4R0ExVWRJd1FZTUJhQQpGTnZZd29OcjFxSFFUc2o2QXd1cDJyUkZ2KzBaTUNvR0ExVWRFUVFqTUNHQ0h5b3VaR1ZtWVhWc2RDNW9kV0ppCmJHVXRaM0p3WXk1amFXeHBkVzB1YVc4d0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFHeUlJcGlzSU5iTTFLaEgKU3V5MTliWC9mNFFsOWxSL05BVmhKR21GYnI1VjRETmR6cDRVRi9KaFZjN2ZYdkRnU1NlTnordGJQZ0FFa1l4VwpsNEhQWHY3YWFkZXora0V2ZkliMkQ3UGdPS3p6RThheEpUMnhRdVEzUFR6ZnhPWklDREc4cDVMT0c1aXB1SnlkCiswWjhKSGRKY1NuSURNN1loalkzak9vQ2JHbHNmdjZFS1d5emlkR1lNNDZ4L0V3UFJpdGpkcmt4bDg0ejhQME4KZlNIR3hvZUVGeHc0YmJJM0diOThRWDVvVEFFc1lLVHkvcFA0a2pDU1VsT1BXUHRIWVJYZng0ZUlib3hvdTJlTgptUDVQTFFSU0M2UUQ0KzF5VnVGOVMrOVJFbHZTMDlGL09zSHlLWDlVY3hRVlZKR3ZvSEtzVm9KbGZlbjRkdTZYCll2WHpFZWs9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
  tls.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBdE5WSWJiazFOMytxM3RkNThFZVFCZWZEcnlGRkJtaXJJOTdTWXNqay90ZGc1dzYrCllTdkQ3UEh1ODBtMksvaHZSQ3cyc1FFZmEwNVdSbHJkUjhDN3dURm8xM3NHb2phL0p3cmU0YlBkU1VtY05YU0YKS1VWMi82SElaaTYrQWdJSVdYSzZRTUw0THp4cDcrVzBxY0dJWFBlRWZlQmtTYkIxbENEM3ZXYkw4WWhnb013Vwo5elpTWHRWL3huTW9VaUZxNVBqQVIrbi9TOTRVK0hyY1p4RWhIYWJ5SlBTYUpkelFBUnBjWnUzdGphTVA4TlNLCkNZR1l0M1VncUNOVTRlNTdSaWZNakgxM0VVYlpHbVhJK1p6emxjL2xNK0JNQSt3VERzYWRzS2FUelVmYXEyekEKSDZURW1VT0pyZ2p5ZVFZRnFORjMvc0JnS0J5QmpuNVl0dTlONVFJREFRQUJBb0lCQUVoR251Wk1DanNlYWRzYgpZSDlxK3VPQldMTWNwd3dDdGJSbWtNd3U0MmdBQ1prUVNZTnBES3dkbnBYYXRsY291c0FTcytGWFE0bU9DK21lCjA2YWtIK2I5cXB2RmJrZFRmbDlLZHY3YTl1MGQ0TE4wMk93LytXbis3YXY1cnJQNnYvK1FYV1VaQ0QxSTlrYU8KRndGcWV1ZzlmZFVaNUx1WExjZUF6Y1FEM0N1eTNFZ295Uzk0N0swNU1sd0wzTWxsamV3ZjhqWXVoWlJBTjlnVgo2cmxSNWVXMFlXdXdWQWdwcHJjaWRHdXBTVzIzU2dFdHM0Zk14RGNNNWQ5ZGU0N29YdHJuZ3E0TC9aRnRneHd4CjdweUJQS3dFQnpyVllmVzF0U21BeUpNVmttbnlEN1BxUHdlNytXRTE3cmloNXFiWFA1QTNqRTlNYyt3NmlXajYKdnh5Mmtaa0NnWUVBek1peVNLNDZNTWJzeEhFWFM1L2YxVlcrTzZlSmszVGFaVGh4SDlHWWNvZHFrTmE2c25kcAp5SkEvWFI2eDFVY1J1UzdiZUQ1QXlhNlorOTZJS1hjd1VVbTRyWGlkUUVGMk5nOXZVWGlQUjRHVERZZFR4MDNGCkpoN3pGSXc0R04xWCtLQ3NXMGQ3K1JDK2R0N2dwY0tBNzlmdFowT1NYaHlLVXo4UGx6N2Zxd01DZ1lFQTRnOGkKR1pOV3EwSDI3VFF2c3RERHp6U0R4bUVuL2pJOVhnRCtSa2JQZE5TNUlsaUNsTnU0MXlkRmFaZ2Z2ZWNPaEdUbApReE5SYkU2bFE3OGRzUnhtdkNsZUtMem9ObDR1VEZ0czVCU1hjWlZ6MVlQMjV1djhlMDBwUkFiK1A5VmVadkJKClA3N1JQRTRHSTdFYndnRUlMZXdIc1lNWDdaZks5NGE2WVU1Qkd2Y0NnWUJYenJLTGNaRm4rdFBwQTJqdXQxV2QKdnc4N3V3SEZwWFJEdEtqazhOVkNQb2hXSkl5WEc1YlROZTdGZWZUY3M0V0k5dXVLS245VE96ZXhoT0N6anZTNwoxaldHeEZJQkRGQ29xNE9hMW12eFNFRUtxdjBrVjFkeW1oQzJ2YzBMOUZUVk9lZk5sK0F6a3Bkb2x2YVNmTTBXCmltcTBQWWdVTEg2dlpUbkZLMk55aXdLQmdRQ0xhSW0rKy80VzN6ZElVVWFaSCtXaGd1RkJGZWx6K2NlZWtUNCsKV0t6WGY5Z3NOaWxSWTY4NkFCM3VZTUl5ZXF1Wk9oK29uZUU0eWNkaFlCc1BmbFJjOWFYN3VZUDdBMW5KL1JmSwpFR2pVd3pZTUZyWE04dnRoanRSRC80d01FYW1HRWVrYVJyTUNYWnVycHkxWEZ3dlVSaHI0ZmIvajVoaGxUZERpCjhUOTFRUUtCZ1FDcXhxdDlvQTJZdW53c1JTZjJDTDhxek5iSnVqalJKdGxvNS8wRFZkV3BLMENoY1RUdndpRngKQzJ3Y0VrbTNkdHBKYzdTa1RWU2FqOVlmWG1UY0JSQ0VTWk4waHYwdGhBd2thTXl3TDBXdHlKeUREMm9IamdBNwpOb2lGd3M2dTRMZ1J5QlVsUXdNQ3VyYzg1M0pzMEVLdW5UR3ZkOWdmYTVQZDRPbksxYlNBUmc9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: cilium-config
  namespace: eqhP0p8GQRH7U1
data:
  identity-allocation-mode: crd
  cilium-endpoint-gc-interval: 5m0s
  disable-endpoint-crd: "false"
  debug: "false"
  enable-policy: default
  enable-ipv4: "true"
  enable-ipv6: "false"
  custom-cni-conf: "false"
  enable-bpf-clock-probe: "true"
  monitor-aggregation: medium
  monitor-aggregation-interval: 5s
  monitor-aggregation-flags: all
  bpf-map-dynamic-size-ratio: "0.0025"
  bpf-policy-map-max: "16384"
  bpf-lb-map-max: "65536"
  bpf-lb-external-clusterip: "false"
  preallocate-bpf-maps: "false"
  sidecar-istio-proxy-image: cilium/istio_proxy
  cluster-name: default
  cluster-id: ""
  tunnel: vxlan
  enable-l7-proxy: "true"
  enable-ipv4-masquerade: "true"
  enable-ipv6-masquerade: "true"
  enable-xt-socket-fallback: "true"
  install-iptables-rules: "true"
  install-no-conntrack-iptables-rules: "false"
  auto-direct-node-routes: "false"
  enable-bandwidth-manager: "false"
  enable-local-redirect-policy: "false"
  kube-proxy-replacement: disabled
  enable-health-check-nodeport: "true"
  node-port-bind-protection: "true"
  enable-auto-protect-node-port-range: "true"
  enable-session-affinity: "true"
  enable-l2-neigh-discovery: "true"
  arping-refresh-period: 30s
  enable-endpoint-health-checking: "true"
  enable-health-checking: "true"
  enable-well-known-identities: "false"
  enable-remote-node-identity: "true"
  operator-api-serve-addr: 127.0.0.1:9234
  enable-hubble: "true"
  hubble-socket-path: /var/run/cilium/hubble.sock
  hubble-listen-address: :4244
  hubble-disable-tls: "false"
  hubble-tls-cert-file: /var/lib/cilium/tls/hubble/server.crt
  hubble-tls-key-file: /var/lib/cilium/tls/hubble/server.key
  hubble-tls-client-ca-files: /var/lib/cilium/tls/hubble/client-ca.crt
  ipam: cluster-pool
  cluster-pool-ipv4-cidr: 10.0.0.0/8
  cluster-pool-ipv4-mask-size: "24"
  disable-cnp-status-updates: "true"
  cgroup-root: /run/cilium/cgroupv2
  enable-k8s-terminating-endpoint: "true"
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: cilium
rules:
  - apiGroups:
      - networking.k8s.io
    resources:
      - networkpolicies
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - discovery.k8s.io
    resources:
      - endpointslices
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - ""
    resources:
      - namespaces
      - services
      - nodes
      - endpoints
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - ""
    resources:
      - pods/finalizers
    verbs:
      - update
  - apiGroups:
      - ""
    resources:
      - nodes
      - pods
    verbs:
      - get
      - list
      - watch
      - update
  - apiGroups:
      - ""
    resources:
      - nodes
      - nodes/status
    verbs:
      - patch
  - apiGroups:
      - apiextensions.k8s.io
    resources:
      - customresourcedefinitions
    verbs:
      - create
      - list
      - watch
      - update
      - get
  - apiGroups:
      - cilium.io
    resources:
      - ciliumnetworkpolicies
      - ciliumnetworkpolicies/status
      - ciliumnetworkpolicies/finalizers
      - ciliumclusterwidenetworkpolicies
      - ciliumclusterwidenetworkpolicies/status
      - ciliumclusterwidenetworkpolicies/finalizers
      - ciliumendpoints
      - ciliumendpoints/status
      - ciliumendpoints/finalizers
      - ciliumnodes
      - ciliumnodes/status
      - ciliumnodes/finalizers
      - ciliumidentities
      - ciliumidentities/finalizers
      - ciliumlocalredirectpolicies
      - ciliumlocalredirectpolicies/status
      - ciliumlocalredirectpolicies/finalizers
      - ciliumegressnatpolicies
      - ciliumendpointslices
    verbs:
      - '*'
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: cilium-operator
rules:
  - apiGroups:
      - ""
    resources:
      - pods
    verbs:
      - get
      - list
      - watch
      - delete
  - apiGroups:
      - discovery.k8s.io
    resources:
      - endpointslices
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - ""
    resources:
      - services
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - ""
    resources:
      - services/status
    verbs:
      - update
  - apiGroups:
      - ""
    resources:
      - services
      - endpoints
      - namespaces
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - cilium.io
    resources:
      - ciliumnetworkpolicies
      - ciliumnetworkpolicies/status
      - ciliumnetworkpolicies/finalizers
      - ciliumclusterwidenetworkpolicies
      - ciliumclusterwidenetworkpolicies/status
      - ciliumclusterwidenetworkpolicies/finalizers
      - ciliumendpoints
      - ciliumendpoints/status
      - ciliumendpoints/finalizers
      - ciliumnodes
      - ciliumnodes/status
      - ciliumnodes/finalizers
      - ciliumidentities
      - ciliumendpointslices
      - ciliumidentities/status
      - ciliumidentities/finalizers
      - ciliumlocalredirectpolicies
      - ciliumlocalredirectpolicies/status
      - ciliumlocalredirectpolicies/finalizers
    verbs:
      - '*'
  - apiGroups:
      - apiextensions.k8s.io
    resources:
      - customresourcedefinitions
    verbs:
      - create
      - get
      - list
      - update
      - watch
  - apiGroups:
      - coordination.k8s.io
    resources:
      - leases
    verbs:
      - create
      - get
      - update
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: cilium
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cilium
subjects:
  - kind: ServiceAccount
    name: cilium
    namespace: default
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: cilium-operator
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cilium-operator
subjects:
  - kind: ServiceAccount
    name: cilium-operator
    namespace: default
---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: cilium
  namespace: eqhP0p8GQRH7U1
  labels:
    k8s-app: cilium
spec:
  selector:
    matchLabels:
      k8s-app: cilium
  updateStrategy:
    rollingUpdate:
      maxUnavailable: 2
    type: RollingUpdate
  template:
    metadata:
      annotations:
        scheduler.alpha.kubernetes.io/critical-pod: ""
      labels:
        k8s-app: cilium
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
              - matchExpressions:
                  - key: kubernetes.io/os
                    operator: In
                    values:
                      - linux
              - matchExpressions:
                  - key: beta.kubernetes.io/os
                    operator: In
                    values:
                      - linux
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchExpressions:
                  - key: k8s-app
                    operator: In
                    values:
                      - cilium
              topologyKey: kubernetes.io/hostname
      containers:
        - name: cilium-agent
          image: quay.io/cilium/cilium:v1.11.4@sha256:d9d4c7759175db31aa32eaa68274bb9355d468fbc87e23123c80052e3ed63116
          imagePullPolicy: IfNotPresent
          command:
            - cilium-agent
          args:
            - --config-dir=/tmp/cilium/config-map
          startupProbe:
            httpGet:
              host: 127.0.0.1
              path: /healthz
              port: 9876
              scheme: HTTP
              httpHeaders:
                - name: brief
                  value: "true"
            failureThreshold: 105
            periodSeconds: 2
            successThreshold: 1
          livenessProbe:
            httpGet:
              host: 127.0.0.1
              path: /healthz
              port: 9876
              scheme: HTTP
              httpHeaders:
                - name: brief
                  value: "true"
            periodSeconds: 30
            successThreshold: 1
            failureThreshold: 10
            timeoutSeconds: 5
          readinessProbe:
            httpGet:
              host: 127.0.0.1
              path: /healthz
              port: 9876
              scheme: HTTP
              httpHeaders:
                - name: brief
                  value: "true"
            periodSeconds: 30
            successThreshold: 1
            failureThreshold: 3
            timeoutSeconds: 5
          env:
            - name: K8S_NODE_NAME
              valueFrom:
                fieldRef:
                  apiVersion: v1
                  fieldPath: spec.nodeName
            - name: CILIUM_K8S_NAMESPACE
              valueFrom:
                fieldRef:
                  apiVersion: v1
                  fieldPath: metadata.namespace
            - name: CILIUM_CLUSTERMESH_CONFIG
              value: /var/lib/cilium/clustermesh/
            - name: CILIUM_CNI_CHAINING_MODE
              valueFrom:
                configMapKeyRef:
                  name: cilium-config
                  key: cni-chaining-mode
                  optional: true
            - name: CILIUM_CUSTOM_CNI_CONF
              valueFrom:
                configMapKeyRef:
                  name: cilium-config
                  key: custom-cni-conf
                  optional: true
          lifecycle:
            postStart:
              exec:
                command:
                  - /cni-install.sh
                  - --enable-debug=false
                  - --cni-exclusive=true
            preStop:
              exec:
                command:
                  - /cni-uninstall.sh
          securityContext:
            privileged: true
            allowPrivilegeEscalation: false
            capabilities:
              drop:
                "": NET_RAW
            readOnlyRootFilesystem: true
          volumeMounts:
            - name: bpf-maps
              mountPath: /sys/fs/bpf
              mountPropagation: Bidirectional
            - name: cilium-run
              mountPath: /var/run/cilium
            - name: cni-path
              mountPath: /host/opt/cni/bin
            - name: etc-cni-netd
              mountPath: /host/etc/cni/net.d
            - name: clustermesh-secrets
              mountPath: /var/lib/cilium/clustermesh
              readOnly: true
            - name: cilium-config-path
              mountPath: /tmp/cilium/config-map
              readOnly: true
            - name: lib-modules
              mountPath: /lib/modules
              readOnly: true
            - name: xtables-lock
              mountPath: /run/xtables.lock
            - name: hubble-tls
              mountPath: /var/lib/cilium/tls/hubble
              readOnly: true
      hostNetwork: true
      initContainers:
        - name: mount-cgroup
          image: quay.io/cilium/cilium:v1.11.4@sha256:d9d4c7759175db31aa32eaa68274bb9355d468fbc87e23123c80052e3ed63116
          imagePullPolicy: IfNotPresent
          env:
            - name: CGROUP_ROOT
              value: /run/cilium/cgroupv2
            - name: BIN_PATH
              value: /opt/cni/bin
          command:
            - sh
            - -ec
            - |
              cp /usr/bin/cilium-mount /hostbin/cilium-mount;
              nsenter --cgroup=/hostproc/1/ns/cgroup --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-mount" $CGROUP_ROOT;
              rm /hostbin/cilium-mount
          volumeMounts:
            - name: hostproc
              mountPath: /hostproc
            - name: cni-path
              mountPath: /hostbin
          securityContext:
            privileged: true
        - name: clean-cilium-state
          image: quay.io/cilium/cilium:v1.11.4@sha256:d9d4c7759175db31aa32eaa68274bb9355d468fbc87e23123c80052e3ed63116
          imagePullPolicy: IfNotPresent
          command:
            - /init-container.sh
          env:
            - name: CILIUM_ALL_STATE
              valueFrom:
                configMapKeyRef:
                  name: cilium-config
                  key: clean-cilium-state
                  optional: true
            - name: CILIUM_BPF_STATE
              valueFrom:
                configMapKeyRef:
                  name: cilium-config
                  key: clean-cilium-bpf-state
                  optional: true
          securityContext:
            privileged: true
          volumeMounts:
            - name: bpf-maps
              mountPath: /sys/fs/bpf
            - name: cilium-cgroup
              mountPath: /run/cilium/cgroupv2
              mountPropagation: HostToContainer
            - name: cilium-run
              mountPath: /var/run/cilium
          resources:
            requests:
              cpu: 100m
              memory: 100Mi
      restartPolicy: Always
      priorityClassName: system-node-critical
      serviceAccount: cilium
      serviceAccountName: cilium
      terminationGracePeriodSeconds: 1
      tolerations:
        - operator: Exists
      volumes:
        - name: cilium-run
          hostPath:
            path: /var/run/cilium
            type: DirectoryOrCreate
        - name: bpf-maps
          hostPath:
            path: /sys/fs/bpf
            type: DirectoryOrCreate
        - name: hostproc
          hostPath:
            path: /proc
            type: Directory
        - name: cilium-cgroup
          hostPath:
            path: /run/cilium/cgroupv2
            type: DirectoryOrCreate
        - name: cni-path
          hostPath:
            path: /opt/cni/bin
            type: DirectoryOrCreate
        - name: etc-cni-netd
          hostPath:
            path: /etc/cni/net.d
            type: DirectoryOrCreate
        - name: lib-modules
          hostPath:
            path: /lib/modules
        - name: xtables-lock
          hostPath:
            path: /run/xtables.lock
            type: FileOrCreate
        - name: clustermesh-secrets
          secret:
            secretName: cilium-clustermesh
            defaultMode: 256
            optional: true
        - name: cilium-config-path
          configMap:
            name: cilium-config
        - name: hubble-tls
          projected:
            defaultMode: 256
            sources:
              - secret:
                  name: hubble-server-certs
                  optional: true
                  items:
                    - key: ca.crt
                      path: client-ca.crt
                    - key: tls.crt
                      path: server.crt
                    - key: tls.key
                      path: server.key
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: cilium-operator
  namespace: eqhP0p8GQRH7U1
  labels:
    io.cilium/app: operator
    name: cilium-operator
spec:
  replicas: 2
  selector:
    matchLabels:
      io.cilium/app: operator
      name: cilium-operator
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      annotations: null
      labels:
        io.cilium/app: operator
        name: cilium-operator
    spec:
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchExpressions:
                  - key: io.cilium/app
                    operator: In
                    values:
                      - operator
              topologyKey: kubernetes.io/hostname
      containers:
        - name: cilium-operator
          image: quay.io/cilium/operator-generic:v1.11.4@sha256:bf75ad0dc47691a3a519b8ab148ed3a792ffa2f1e309e6efa955f30a40e95adc
          imagePullPolicy: IfNotPresent
          command:
            - cilium-operator-generic
          args:
            - --config-dir=/tmp/cilium/config-map
            - --debug=$(CILIUM_DEBUG)
          env:
            - name: K8S_NODE_NAME
              valueFrom:
                fieldRef:
                  apiVersion: v1
                  fieldPath: spec.nodeName
            - name: CILIUM_K8S_NAMESPACE
              valueFrom:
                fieldRef:
                  apiVersion: v1
                  fieldPath: metadata.namespace
            - name: CILIUM_DEBUG
              valueFrom:
                configMapKeyRef:
                  key: debug
                  name: cilium-config
                  optional: true
          livenessProbe:
            httpGet:
              host: 127.0.0.1
              path: /healthz
              port: 9234
              scheme: HTTP
            initialDelaySeconds: 60
            periodSeconds: 10
            timeoutSeconds: 3
          volumeMounts:
            - name: cilium-config-path
              mountPath: /tmp/cilium/config-map
              readOnly: true
      hostNetwork: true
      restartPolicy: Always
      priorityClassName: system-cluster-critical
      serviceAccount: cilium-operator
      serviceAccountName: cilium-operator
      tolerations:
        - operator: Exists
      volumes:
        - name: cilium-config-path
          configMap:
            name: cilium-config
